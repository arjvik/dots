#!/bin/bash
set -euo pipefail

ROFIMOJI_LOCATION="$HOME/Software/rofimoji"


if ! [[ -f "$ROFIMOJI_LOCATION/bin/rofimoji" ]]; then
	RED="$(tput setaf 1)"
	BOLD="$(tput bold)"
	NORMAL="$(tput sgr0)"
	printf "${RED}${BOLD} Downloading rofimoji from GitHub ${NORMAL}\n"
	rm -rf "$ROFIMOJI_LOCATION"
	git clone https://github.com/fdw/rofimoji "$ROFIMOJI_LOCATION"
	printf "${RED}${BOLD} - Creating virtualenv ${NORMAL}\n"
	cd "$ROFIMOJI_LOCATION"
	virtualenv .
	source bin/activate
	printf "${RED}${BOLD} - Installing rofimoji${NORMAL}\n"
	python3 setup.py install
	deactivate
	printf "${RED}${BOLD} - Done! ${NORMAL}\n"
fi

source $ROFIMOJI_LOCATION/bin/activate
rofimoji "$@"
deactivate
